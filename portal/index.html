<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <title>
    Portal CSS - CSS Animation
  </title>
  <meta
    name="description"
    content="Recreating the classic Portal intstruction video using HTML and CSS"
  />
  
  <link rel="stylesheet" href="//fast.fonts.net/cssapi/ac2fb2fd-d7da-40b3-b713-85f23384b3af.css" />
  <link rel="stylesheet" href="/css/main.css" />
  
  <link rel="stylesheet" href="/css/custom/portal.css" />
  
  
  <link rel="canonical" href="/portal/" />
  <link rel="alternate" type="application/rss+xml" title="CSS Animation" href="/feed.xml" />
  
  
  <meta property="twitter:card" content="summary" />
  <meta property="twitter:site" content="@cssanimation" />
  <meta property="twitter:creator" content="@donovanh" />
  <meta property="og:title" content="Portal CSS - CSS Animation" />
  <meta property="og:description" content="Recreating the classic Portal intstruction video using HTML and CSS" />
  <meta property="og:image" content="/images/posts/portal/home.png" />
  <meta property="og:url" content="/portal/" />
  

  <meta name="mobile-web-app-capable" content="yes" />
  <link rel="icon" sizes="192x192" href="/images/favicons/favicon-192x192.png" />
  <meta name="apple-mobile-web-app-title" content="CSS Animation" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  <link rel="apple-touch-icon-precomposed" href="/images/favicons/apple-touch-icon-152x152.png" />
  <meta name="msapplication-TileImage" content="/images/favicons/apple-touch-icon-144x144.png" />
  <meta name="msapplication-TileColor" content="#fcf5f2" />

  <link rel="shortcut icon" href="/images/favicons/favicon.ico" />
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  
  <meta name="google-site-verification" content="5imT8mOKPjwxAqlEs9aU4uh4jBcsYQyMNdlKgU1Dja8" />

  <style>
    .wow {
      visibility: hidden;
    }
  </style>
</head>


  <body class="">
    

  <section class="post-header">

    <section class="logo">
      <a href="/">
        <section class="svg-logo">
          <a href="/"><img src="/images/rocky.svg" alt="CSS Animation"></a>
        </section>
      </a>
    </section>
    
      <section class="demo">
        <section class="demo-container container">
  <div class="portal">
    <section class="stage">
      <div class="shadow"></div>
      <div class="back-left"></div>
      <div class="back-right"></div>
      <div class="platform-left"><span></span></div>
      <div class="platform-right"><span></span></div>
      <div class="pit-left"></div>
      <div class="pit-right"></div>
      <div class="pit-back"></div>
      <div class="door"></div>
      <div class="portal red"></div>
      <div class="portal blue"></div>
      <div class="person one">
        <figure class="head"></figure>
        <figure class="body"></figure>
        <div class="person-shadow one">
          <figure class="head"></figure>
          <figure class="body"></figure>
        </div>
      </div>
      <div class="person two">
        <figure class="head"></figure>
        <figure class="body"></figure>
        <figure class="arm left"></figure>
        <figure class="arm right"></figure>
        <div class="person-shadow two">
          <figure class="head"></figure>
          <figure class="body"></figure>
          <figure class="arm left"></figure>
          <figure class="arm right"></figure>
        </div>
      </div>
    </section>
  </div>
</section>
<section class="fallback"></section>

      </section>
    
    <div class="absolute-nav">
      <nav>
  <ul>
    <li><a href="/courses/">Learn CSS Animation</a></li>
    <li><a href="https://weekly.cssanimation.rocks">Weekly Newsletter</a></li>
  </ul>
</nav>

    </div>
  </section>

<section class="container page-content">
  <section class="row">
    <article class="post-content nine columns ">
      <h1 class="post-title" style="margin-bottom:4px;">Portal CSS</h1>
      <p style="font-size: 14px;margin-top: 0;color: #aaa;" class="date">July 8, 2015</p>
      
      <p>You don't need JavaScript to create impressive 3D projects in the web browser. In this post I will show how to create and animate a Portal-inspired scene using only CSS.</p>
<p>See the <a href="http://hop.ie/portal/">online Portal CSS demo</a>, and download the <a href="https://github.com/donovanh/portal">source on Github</a>.</p>
<h2 id="portal-orientation-video-no.-1" tabindex="-1">Portal Orientation Video No. 1</h2>
<p>As an example to show the various stages of creating, styling and then animating a 3D scene, this post will aim to recreate a scene from the <a href="http://www.youtube.com/watch?v=gr_9Fw_gC4I">Portal Training Video</a>. In particular, the stylised, cartoony look of the first part of the video in which a silhouetted character jumps through a portal and emerges from the other side. This is the original video:</p>
<div class="videoWrapper">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/V5paXrfkYmI?modestbranding=1&cc_load_policy=0&iv_load_policy=3&vq=hd720" frameborder="0" allowfullscreen></iframe>
</div><br>
<p>This video blew my mind when it was first released. Portal (which was developed from <a href="http://en.wikipedia.org/wiki/Narbacular_Drop">Narbacular Drop</a>) introduced a fun twist on the 3D platform genre.</p>
<p>The isometric, cartoony graphics in the introduction video are very different from the game yet manage to capture some of it's style. In this post I will see if this cartoony style can be reproduced using nothing but HTML and CSS.</p>
<p>In particular, this is the scene that will be created:</p>
<img src="/images/posts/portal/video.jpg" alt="Portal video screenshot" />
<h3 id="a-quick-note-on-prefixes" tabindex="-1">A quick note on prefixes</h3>
<p>I've removed the prefixed versions of rules in the following CSS. I would recommend either using something like <a href="http://leaverou.github.io/prefixfree/">prefix free</a> or <a href="http://sass-lang.com/">SASS</a> to manage these for you. Otherwise, be aware that most browser prefixes will need to applied. Full versions of the CSS and SASS can be found <a href="https://github.com/donovanh/portal">on Github</a> along with the HTML.</p>
<h3 id="there's-science-to-be-done" tabindex="-1">There's science to be done</h3>
<p>The following project has been developed and tested primarily in Chrome. It uses CSS that won't work properly in Internet Explorer. It covers some interesting 3D CSS techniques that while they aren't yet mainstream, can prove useful in other front-end development.</p>
<h2 id="getting-started" tabindex="-1">Getting started</h2>
<p>We need to set a scene in which we can build our 3D creation. To do this we'll need to use an HTML element and give it the needed properties that tell the browser to expect 3D content within it. Start with some HTML:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>...<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span></code></pre>
<p>In this case the container is an <code>article</code> tag. In HTML5, <em>article</em> represents a standalone piece of content that could be reproduced elsewhere and still make sense.</p>
<p>The first property to apply is <a href="http://docs.webplatform.org/wiki/css/properties/perspective">perspective</a>. This property takes a value in pixels, and represents the depth of the 3D scene. A smaller value will produce a more dramatic effect, and it's usual to set it somewhere betweeh 800 and 1,200 pixels.</p>
<img src="/images/posts/portal/perspective.gif" alt="Alternating between a perspective value of 900 pixels and 2000 pixels" class="bordered centered" />
<p>For this scene to feel like it's a large room, we will set the perspective value quite high at 2,600 pixels. Ignoring the various browser prefixes, we use the following:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">article.container</span> <span class="token punctuation">{</span>
  <span class="token property">perspective</span><span class="token punctuation">:</span> 2600px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="vanishing-point" tabindex="-1">Vanishing point</h3>
<p>The container for the scene has a depth, so the next step is to determine the viewing angle. By adjusting the <a href="http://docs.webplatform.org/wiki/css/properties/perspective-origin">perspective-origin</a> property, we can establish the scene's vanishing point, and determine whether we're looking down at the object or from the side.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">perspective-origin</span><span class="token punctuation">:</span> 50% -1400px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The <code>perspective-origin</code> property takes two values, a horizontal and a vertical offset. In this case we're setting it half-way across the scene, and 1,400 pixels up. This will result in our point of view being above the object, looking down.</p>
<p>To determine these values, I adjusted the value in the Chrome web inspector panel and judged it by eye. When setting up your scene, your value might be higher or lower than this. It will depend on the effect you want to convey. Also keep in mind that this value can be animated, creating some interesting perspective-change effects.</p>
<h3 id="no-vectors%2C-victor" tabindex="-1">No vectors, Victor</h3>
<p>The objects we position in HTML are normal HTML elements. They have a width, height, and are rectangular. This means that as you build a 3D object, you place each rectangle in place. This differs from some other methods that involve describing points and lines to create shapes. It also means that there aren't as many primatives, such as circles or cubes, to draw upon.</p>
<p>The HTML elements are placed within the 3D scene using the <code>transform</code> property.</p>
<h3 id="transforming" tabindex="-1">Transforming</h3>
<p>The <code>transform</code> property consists of a series of adjustments to the HTML element. These adjustments can take the form of <code>translate</code> to move the element, <code>rotate</code> to adjust it's angle, <code>skew</code> and even <code>scale</code>. Each of these can be stacked to create more complex transforms, for example:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.example</span> <span class="token punctuation">{</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>45deg<span class="token punctuation">)</span> <span class="token function">translateZ</span><span class="token punctuation">(</span>-100px<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>This rule will rotate an element 45 degrees around the Y axis, then move it back 100 pixels on the Z axis. The effect would look like this:</p>
<img src="/images/posts/portal/transform.png" alt="A transform in action" class="bordered centered" />
<h3 id="transform-origin-property" tabindex="-1">Transform origin property</h3>
<p>When rotating elements around the place, it's worth keeping in mind that the transforms have an origin that can be set. The <a href="http://docs.webplatform.org/wiki/css/properties/transform-origin">transform origin</a> is a point referred to by specifying the X, Y and Z values. This is the default:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.default-origin</span> <span class="token punctuation">{</span>
  <span class="token property">transform-origin</span><span class="token punctuation">:</span> 50% 50% 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>When building this example I kept the default but it's worth knowing that it's there.</p>
<h2 id="let's-build" tabindex="-1">Let's build</h2>
<p>With the scene set, we can start putting together our 3D masterpiece. When beginning to build 3D objects with HTML and CSS, it's worth taking a moment to understand how this approach differs from other 3D software.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stage<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>shadow<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>back-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>back-right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>platform-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>platform-right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pit-left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pit-right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pit-back<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span></code></pre>
<p>The above includes a <em>stage</em> section, which we will be using to contain all the elements. A set of divs within the stage section form the main parts of the structure. They take the form of back pieces, platforms, the sides of the pit, and a shadow to place underneath them.</p>
<p>When I started building this scene, I tried to place the walls directly onto the stage, rotating it and adjusting its position. However since the scene is being viewed from an isometric angle, an easier approach is to place the parts of the scene and then rotate the entire scene 45 degrees at once.</p>
<p>With that in mind, the HTML elements are transformed into place according to the following sketch:</p>
<img src="/images/posts/portal/sketch.png" alt="Plan view of the scene" class="centered" />
<p>As the sketch shows, the <em>back-left</em> piece is aligned to the left, but the <em>back-right</em> piece is right in front of the viewer. To adjust for this, we'll rotate the entire stage 45 degrees later.</p>
<p>Before applying transforms however, we need to give the divs some shared properties:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage div</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">transform-style</span><span class="token punctuation">:</span> preserve-3d<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Each div will be positioned absolutely, and the <code>transform-style</code> property to instruct the browser that 3D transforms are to be applied in relation to the perspective we set earlier.</p>
<p>With this done we can start positioning divs:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .back-left</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #6b522b<span class="token punctuation">;</span>
  <span class="token property">border-left</span><span class="token punctuation">:</span> 6px solid #574625<span class="token punctuation">;</span>
  <span class="token property">border-top</span><span class="token punctuation">:</span> 6px solid #8a683d<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>90deg<span class="token punctuation">)</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-256px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 500px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The above rules describe a width of 500 pixels, which is the side length of our 3D scene, a height of 120 pixels and a light brown background colour. The div is then rotated 90 degrees and pushed back along the X axis. The div has a 6 pixel border applied to create the illusion of depth.</p>
<p>A similar transform is applied to the <em>back-right</em> div:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .back-right</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #9c7442<span class="token punctuation">;</span>
  <span class="token property">border-right</span><span class="token punctuation">:</span> 6px solid #78552c<span class="token punctuation">;</span>
  <span class="token property">border-top</span><span class="token punctuation">:</span> 6px solid #b5854a<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>253px<span class="token punctuation">)</span> <span class="token function">translateZ</span><span class="token punctuation">(</span>3px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 446px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>This div is a little smaller, as it looks like the room in the original Portal video is not quite square.</p>
<p>Next, add in some platforms and the sides of the pit:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .platform-left</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #bcb3a8<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 6px solid #857964<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 220px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotateX</span><span class="token punctuation">(</span>90deg<span class="token punctuation">)</span> <span class="token function">translateY</span><span class="token punctuation">(</span>396px<span class="token punctuation">)</span> <span class="token function">translateX</span><span class="token punctuation">(</span>253px<span class="token punctuation">)</span> <span class="token function">translateZ</span><span class="token punctuation">(</span>-13px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 446px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .platform-right</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #bcb3a8<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 6px solid #847660<span class="token punctuation">;</span>
  <span class="token property">border-right</span><span class="token punctuation">:</span> 6px solid #554c3d<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 164px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotateX</span><span class="token punctuation">(</span>90deg<span class="token punctuation">)</span> <span class="token function">translateY</span><span class="token punctuation">(</span>88px<span class="token punctuation">)</span> <span class="token function">translateX</span><span class="token punctuation">(</span>253px<span class="token punctuation">)</span> <span class="token function">translateZ</span><span class="token punctuation">(</span>-41px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 446px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .pit-left</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #4d4233<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 800px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>254px<span class="token punctuation">,</span> 125px<span class="token punctuation">,</span> 285px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 447px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .pit-right</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #847660<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 800px<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> -1400px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>254px<span class="token punctuation">,</span> 125px<span class="token punctuation">,</span> 173px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 451px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .pit-back</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #6b522b<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 220px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>90deg<span class="token punctuation">)</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>-200px<span class="token punctuation">,</span> 87px<span class="token punctuation">,</span> 168px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 170px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The end result of all this should be a scene that looks like this:</p>
<img src="/images/posts/portal/layout01.png" alt="Initial layout of the stage divs" />
<p>It doesn't look right yet. We need to rotate the entire scene to see it properly. Add a <code>transform</code> to the <em>scene</em> section:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage</span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
  <span class="token property">transform-style</span><span class="token punctuation">:</span> preserve-3d<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>-45deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 460px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The result should look more like this:</p>
<img src="/images/posts/portal/layout02.png" alt="Initial layout rotated to show the stage properly" />
<p>You may notice that the borders create a nice depth effect, particularly at the corners, where the different coloured borders meet with a 45 degree angle. Since the scene we're building is to be viewed at 45 degrees, this effect works to our advantage in most cases. A few of the corners don't quite look right, but considering how straightforward the borders are to apply, and the lack of images, I feel this is a reasonable compromise.</p>
<h3 id="in-the-shade" tabindex="-1">In the shade</h3>
<p>The video features a nice shadow beneath the platforms. We can reproduce this using the CSS <code>box-shadow</code> property.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .shadow</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> -600px 0 50px #afa79f<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 550px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotateX</span><span class="token punctuation">(</span>90deg<span class="token punctuation">)</span> <span class="token function">translateZ</span><span class="token punctuation">(</span>-166px<span class="token punctuation">)</span> <span class="token function">translateX</span><span class="token punctuation">(</span>550px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 550px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The rules above add a box shadow to the <em>shadow</em> div, which is itself transparent. The box shadow is offset by 600 pixels so that the actual <em>shadow</em> div doesn't get in the way of the shadow. The whole lot is rotated and positioned off-stage, so that only the shadow part is visible on the stage. The result should be something like this:</p>
<img src="/images/posts/portal/layout03.png" alt="Initial layout with a shadow" />
<h2 id="red-vs-blue" tabindex="-1">Red VS Blue</h2>
<p>Next up we need to add some decoration and the glowing portals.</p>
<img src="/images/posts/portal/portal.png" alt="Red portal" />
<p>The HTML needed for the two portals is simple enough:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>portal red<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>portal blue<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre>
<p>There is a <code>div</code> for each of the two portals, one red and the other blue. They both have a similar style, with gradients used to create glowing effect. Since they are only one HTML element, the CSS includes a pseudo-element we can style to achieve the full effect.</p>
<p>The first step is to establish the general portal shape:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .portal</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 44px/62px<span class="token punctuation">;</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 15px 4px white<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 72px<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 48px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>This sets up the portal and uses the <code>border-radius</code> property to create an oval shape, and a white box shadow creates a glow. A pseudo-element is then added that has similar dimensions, and the white border:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .portal:before</span> <span class="token punctuation">{</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 44px/62px<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 4px solid white<span class="token punctuation">;</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 72px<span class="token punctuation">;</span>
  <span class="token property">margin-left</span><span class="token punctuation">:</span> -4px
  <span class="token property">margin-top</span><span class="token punctuation">:</span> -4px<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 48px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>So far these styles have both applied to portals in general. Since one is red and the other blue, we'll use separate sets of CSS rules to describe the characteristics specific to each. Firstly, the red portal:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .portal.red</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">radial-gradient</span><span class="token punctuation">(</span>#000000<span class="token punctuation">,</span> #000000 50%<span class="token punctuation">,</span> #ff4640 70%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 7px solid #ff4640<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>223px<span class="token punctuation">,</span> 25px<span class="token punctuation">,</span> 385px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>90deg<span class="token punctuation">)</span> <span class="token function">skewX</span><span class="token punctuation">(</span>5deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .portal.blue</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">radial-gradient</span><span class="token punctuation">(</span>#000000<span class="token punctuation">,</span> #000000 50%<span class="token punctuation">,</span> #258aff 70%<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 7px solid #258aff<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>586px<span class="token punctuation">,</span> 25px<span class="token punctuation">,</span> 4px<span class="token punctuation">)</span> <span class="token function">skewX</span><span class="token punctuation">(</span>-5deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The red portal is given a background <a href="http://docs.webplatform.org/wiki/css/functions/radial-gradient">radial gradient</a> and a red border. The transform in this case rotates it and places it on the left wall. The blue portal is similar but has a blue gradient applied and is positioned on the right wall. Both looked a little off in testing, so I added a 5 degree skew effect that seemed to make them look a little better.</p>
<h3 id="portal-glow" tabindex="-1">Portal glow</h3>
<p>The HTML we added earlier included a <code>span</code> tag within each of the two platforms. These spans were added so that they could be styled with a radial gradient to provide a glowing effect beneath each portal.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .platform-left span</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">radial-gradient</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> #f3cac8<span class="token punctuation">,</span> #c8b8ad 70px<span class="token punctuation">,</span> #bcb3a8 90px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 120px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .platform-right span</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">radial-gradient</span><span class="token punctuation">(</span>top<span class="token punctuation">,</span> #cdebe8<span class="token punctuation">,</span> #c2cbc1 40px<span class="token punctuation">,</span> #bcb3a8 60px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 60px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 280px<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 150px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The two spans are positioned absolutely and given a red and blue gradient, positioned beneath each of the portals. A pseudo-element could have been used to achieve this effect, but since animating pseudo-elements is not well supported (even within versions of Webkit), a separate span is used in this case.</p>
<h3 id="the-door" tabindex="-1">The Door</h3>
<p>One of the unexpected successes was the use of borders to create what looks like an opening in the right wall, representing the exit. To create this door I use a single div and some coloured borders that make it look like it's inset.</p>
<img src="/images/posts/portal/door.png" alt="Door" />
<p>The door HTML is straightforward. Add the following within the <em>stage</em> section.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>door<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre>
<p>Styling the door involves a few borders and then a transform that positions it in front of the right wall:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .door</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> #efe8dd<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> 6px solid #bcb3a8<span class="token punctuation">;</span>
  <span class="token property">border-left</span><span class="token punctuation">:</span> 7px solid #78552e<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 85px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>450px<span class="token punctuation">,</span> 34px<span class="token punctuation">,</span> 4px<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 65px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Two borders are used to create the effect. The bottom and left borders match the platform and the side of the right wall, giving the impression of depth. Since there is no top border specified, the left border stops flush with the top of the div, which in this case works well.</p>
<h2 id="characters" tabindex="-1">Characters</h2>
<p>With the portals and door in place, we need a person to jump through one and arrive on the other side. The first step is to create the person that jumps through the two portals.</p>
<p>In my initial testing, I tried using one character and having the animation stop at the first portal, and immediately continue from the other side. However when I animated the single character there was a flicker as it moved between portals. To avoid this, I instead used two characters and animated them separately.</p>
<h3 id="building-the-character" tabindex="-1">Building the character</h3>
<img src="/images/posts/portal/dude1.png" alt="The first of two characters to animate through the scene" />
<p>The beginning character shape is made up of 2 main parts, a head and body. Legs are added using pseudo-elements on the body. A similar structure is also included to be used as a shadow:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dude one<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dude-shadow one<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre>
<p>Since the shadow is contained within the character's containing div, it can be animated at the same time. The CSS is as follows:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.dude, .dude-shadow</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100px<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.dude figure, .dude-shadow figure</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.dude figure.head, .dude-shadow figure.head</span> <span class="token punctuation">{</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 22px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.dude figure.body, .dude-shadow figure.body</span> <span class="token punctuation">{</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> 30px 30px 0 0<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 21px<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 26px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.dude figure.body:before, .dude figure.body:after, .dude-shadow figure.body:before, .dude-shadow figure.body:after</span> <span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">""</span><span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 9px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.dude figure.body:before, .dude-shadow figure.body:before</span> <span class="token punctuation">{</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.dude figure.body:after, .dude-shadow figure.body:after</span> <span class="token punctuation">{</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>These rules double up in each case, describing both the character and their shadow. Each of the parts is absolutely positioned and <code>border-radius</code> is used to create the round shapes. The leg pseudo-elements are described at once then each positioned in separate rules.</p>
<h3 id="character-1" tabindex="-1">Character 1</h3>
<p>With the character shape specified, position the character at the starting position:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .dude.one</span> <span class="token punctuation">{</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>514px<span class="token punctuation">,</span> 50px<span class="token punctuation">,</span> 375px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>78deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .dude-shadow.one</span> <span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0.1<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-12px<span class="token punctuation">)</span> <span class="token function">rotateX</span><span class="token punctuation">(</span>90deg<span class="token punctuation">)</span> <span class="token function">translateY</span><span class="token punctuation">(</span>8px<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The CSS transforms position both the character itself but also the shadow. The opacity of the shadow is set to 0.1 rather than set it a grey colour. This allows background details to be seen behind the shadow.</p>
<p>The first character is now at the starting position, and rotated to a similar angle to that in the video. We will add animation later to have them jump through the portals.</p>
<h3 id="armed" tabindex="-1">Armed</h3>
<img src="/images/posts/portal/dude2.png" alt="The second of two characters to animate through the scene" />
<p>The second character has some more detail, arms. The idea being when the character jumps through the portal, they'll celebeate by raising their arms. Here's the HTML:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dude two<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>arm left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>arm right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dude-shadow two<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>head<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>body<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>arm left<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>figure</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>arm right<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>figure</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code></pre>
<p>The second character will begin the animation invisible, and then jump through the portal about halfway through the animation (after the first character reaches their portal). To set this up, this second character is positioned at the portal.</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.stage .dude.two</span> <span class="token punctuation">{</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>610px<span class="token punctuation">,</span> 40px<span class="token punctuation">,</span> 10px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>15deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .dude.two figure.arm</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> black<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .dude.two figure.arm.left</span> <span class="token punctuation">{</span>
  <span class="token property">left</span><span class="token punctuation">:</span> -13px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotateZ</span><span class="token punctuation">(</span>40deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .dude.two figure.arm.right</span> <span class="token punctuation">{</span>
  <span class="token property">right</span><span class="token punctuation">:</span> -10px<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">rotateZ</span><span class="token punctuation">(</span>-40deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.stage .dude-shadow.two</span> <span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0.1<span class="token punctuation">;</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateY</span><span class="token punctuation">(</span>12px<span class="token punctuation">)</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-16px<span class="token punctuation">)</span> <span class="token function">translateZ</span><span class="token punctuation">(</span>-6px<span class="token punctuation">)</span> <span class="token function">rotateZ</span><span class="token punctuation">(</span>-90deg<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>90deg<span class="token punctuation">)</span> <span class="token function">rotateZ</span><span class="token punctuation">(</span>50deg<span class="token punctuation">)</span> <span class="token function">skewX</span><span class="token punctuation">(</span>30deg<span class="token punctuation">)</span> <span class="token function">scaleX</span><span class="token punctuation">(</span>0.8<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>A second animation will be applied to the arms, in which they will also be invisible to begin with but then appear later.</p>
<h2 id="the-stage-is-set" tabindex="-1">The stage is set</h2>
<p>With the characters and the backdrop in place, the scene is ready for some animation.</p>
<img src="/images/posts/portal/stage_set.png" alt="The scene is ready, with 2 characters ready to be animated." />
<p>Let's look at how to make it look like the little person jumps through the first portal and arrives at the other.</p>
<h2 id="animation" tabindex="-1">Animation</h2>
<p>If you <a href="http://hop.ie/portal/">view the demo</a> you'll see a few animations taking place. Rather than go through all the animations that set up the scene, I'll focus on the animation of the character jumping through the portals.</p>
<h3 id="keyframe-animation" tabindex="-1">Keyframe animation</h3>
<p>Timing and animating the HTML elements is achieved by using <a href="http://docs.webplatform.org/wiki/css/atrules/@keyframes">keyframes</a>, and then attaching the set of keyframes to an element using the <a href="http://docs.webplatform.org/wiki/css/properties/animation">animation</a> property.</p>
<p>The first thing is to animate the first character, to have them approach and then jump into the left portal. Here's a set of keyframes that achieves this:</p>
<pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@keyframes</span> move-dude-one</span> <span class="token punctuation">{</span>
  <span class="token comment">/* Character flies into scene */</span>
  <span class="token selector">0%</span> <span class="token punctuation">{</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>514px<span class="token punctuation">,</span> -10px<span class="token punctuation">,</span> 375px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>78deg<span class="token punctuation">)</span> <span class="token function">scaleY</span><span class="token punctuation">(</span>2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* Waits a moment */</span>
  <span class="token selector">1%, 18%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>514px<span class="token punctuation">,</span> 50px<span class="token punctuation">,</span> 375px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>78deg<span class="token punctuation">)</span> <span class="token function">scaleY</span><span class="token punctuation">(</span>1<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* Moves toward the portal */</span>
  <span class="token selector">34%, 39%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>284px<span class="token punctuation">,</span> 40px<span class="token punctuation">,</span> 375px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>78deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* Pauses, them jumps in */</span>
  <span class="token selector">41%, 42%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>234px<span class="token punctuation">,</span> 40px<span class="token punctuation">,</span> 375px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>78deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* Vanishes */</span>
  <span class="token selector">43%, 100%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>234px<span class="token punctuation">,</span> 40px<span class="token punctuation">,</span> 375px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>78deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">/* Note: Use prefixes, such as @-webkit-keyframes, @-moz-keyframes, etc! */</span></code></pre>
<p>Keyframes are a series of steps, described using percentages. The percentage relates to the animation time, so that if an animation was to last 10 seconds, 10% would be the 1 second mark. 90% would be the 9 second mark.</p>
<p>To have the characters jumping through the portals in a nice loop, we'll set two animations that are each 10 seconds long so that they match. I have put some inline comments that describe each stage of the animation. The <code>transform</code> property is used at each stage to set the characters position and angle.</p>
<p>At 43% through the animation, the character's <code>opacity</code> is set to 0. This is when the first character vanishes into the portal. The second character should therefore appear at 43% through it's animation.</p>
<p>Before we do that, let's apply this first animation to the first character:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.dude.one</span> <span class="token punctuation">{</span>
  <span class="token property">animation</span><span class="token punctuation">:</span> move-dude-one 10s linear infinite<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>The <code>animation</code> property above applies the animation to the <em>dude one</em> element. It attaches it with the animation name, sets it to last for 10 seconds, and suggests that it loop infinitely.</p>
<p>An opacity of 0 is set to ensure the character is invisible before the animation starts.</p>
<p>Having done that let's set up the corresponding animation keyframes for the second character:</p>
<pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@keyframes</span> move-dude-two</span> <span class="token punctuation">{</span>
  <span class="token comment">/* Dude be invisible */</span>
  <span class="token selector">0%, 42%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>610px<span class="token punctuation">,</span> 40px<span class="token punctuation">,</span> 10px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>15deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* Apparato! */</span>
  <span class="token selector">42.5%</span> <span class="token punctuation">{</span>
    <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>610px<span class="token punctuation">,</span> 40px<span class="token punctuation">,</span> 10px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>15deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* Move onto the platform */</span>
  <span class="token selector">46%, 75%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>610px<span class="token punctuation">,</span> 40px<span class="token punctuation">,</span> 120px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>15deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* Stand there for a bit */</span>
  <span class="token selector">76%, 97%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>610px<span class="token punctuation">,</span> -10px<span class="token punctuation">,</span> 120px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>15deg<span class="token punctuation">)</span> <span class="token function">scaleY</span><span class="token punctuation">(</span>2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* Fly up into the sky! */</span>
  <span class="token selector">98%, 100%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3D</span><span class="token punctuation">(</span>610px<span class="token punctuation">,</span> -10px<span class="token punctuation">,</span> 120px<span class="token punctuation">)</span> <span class="token function">rotateY</span><span class="token punctuation">(</span>15deg<span class="token punctuation">)</span> <span class="token function">scaleY</span><span class="token punctuation">(</span>2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<pre class="language-css"><code class="language-css"><span class="token atrule"><span class="token rule">@keyframes</span> arms</span> <span class="token punctuation">{</span>
  <span class="token comment">/* No arms */</span>
  <span class="token selector">0%, 53%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/* Yes arms! */</span>
  <span class="token selector">54%, 100%</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>As planned, this animation begins around the 42% mark. The character leaps out of the portal, stands around for a bit, then is whisked away into the sky. A second set of keyframes describe the arms animation. These start off invisible and then show around halfway through the animation.</p>
<p>We can apply these keyframes to the second dude's element as follows:</p>
<pre class="language-css"><code class="language-css"><span class="token selector">.dude.two</span> <span class="token punctuation">{</span>
  <span class="token property">animation</span><span class="token punctuation">:</span> move-dude-two 10s linear infinite<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<pre class="language-css"><code class="language-css"><span class="token selector">.dude.two figure.arm</span> <span class="token punctuation">{</span>
  <span class="token property">animation</span><span class="token punctuation">:</span> arms 10s linear infinite<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>In this way the two animations are being applied. Since both are set to last 10 seconds, and loop infinitely, they should match up nicely with the timing of the first animation.</p>
<p>If you haven't already, <a href="http://hop.ie/portal/">check out the finished result</a> in a modern browser, though preferably not Internet Explorer.</p>
<h2 id="caveats-%26-browser-quirks" tabindex="-1">Caveats &amp; browser quirks</h2>
<p>While we're on the subject of browsers, I should note that this is not going to work currently in Internet Explorer. Firefox is a bit <em>meh</em> but not bad, Safari's almost there (waiting for Apple to patch webkit at long last), and Chrome is 100%. Hey, browsers gonna browse.</p>
<p>Performance is pretty good across various devices (browser issues aside). Testing on an iPhone with Safari and it performs better than Chrome on a laptop. This is because the CSS rules used (3D transforms) make use of the graphic hardware.</p>
<h2 id="demo-and-contact-info" tabindex="-1">Demo and contact info</h2>
<p>Check out the <a href="http://hop.ie/portal">online Portal CSS demo</a> or download the <a href="https://github.com/donovanh/portal">source from Github</a>.</p>


      <section class="post-footer">
        <section class="quote-container">
          <section class="rocky">
            <img src="/images/rocky.svg">
          </section>
          <blockquote>
            <p>Make sure to <a href="https://twitter.com/cssanimation">follow on Twitter</a> for all the latest updates!</p>
          </blockquote>
        </section>
      </section>
    </article>
    
    <aside class="post-aside three columns">
      
        <section class="demo-link">
          <a href="https://cssanimation.rocks/demo/portal/" class="button primary-button">Demo</a>
        </section>
      

      
        
          <section class="translations" style="padding-top: 2em">
            <h3>Translations</h3>
            <!--<p class="translation-message">CSS Animation articles are translated by our community - and you can too!</p>-->
            <!-- Translation links will be handled by data -->
          </section>
        
      
      
      <section class="esteemed-benefactors">
        <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?serve=CEBICK7W&placement=cssanimationrocks" id="_carbonads_js"></script>
      </section>
    </aside>
  </section>
</section>

    <div class="email-signup" id="email-signup" style="max-width: 500px; margin: 0 auto">
  <h2>CSS Animation Weekly</h2>
  <p>The latest tutorials and inspiration every week!</p>
  <iframe
    src="https://embeds.beehiiv.com/5c8b2503-5d81-4b56-8dd8-da3a39a1d3be?slim=true"
    data-test-id="beehiiv-embed"
    frameborder="0"
    scrolling="no"
    style="margin: 0; border-radius: 0px !important; background-color: transparent;"
  ></iframe>
</div>

<footer class="footer">
  <section class="container">
    <section class="row">
      <p>
        <a href="mailto:hello@cssanimation.rocks">Get in touch</a>
        
        <a href="/courses/">CSS Courses</a>
      </p>
    </section>
    <section class="row" style="text-align: center">
      <p>
        
          
            
            <a href="/ar/"></a>
          
             | 
            <a href="/cn/"></a>
          
             | 
            <a href="/da/">Danske</a>
          
             | 
            <a href="/de/">Deutsch</a>
          
             | 
            <a href="/es/">Espaol</a>
          
             | 
            <a href="/fr/">Franais</a>
          
             | 
            <a href="/jp/"></a>
          
             | 
            <a href="/nl/">Nederlands</a>
          
             | 
            <a href="/pt/">Portugus</a>
          
             | 
            <a href="/pl/">Polski</a>
          
             | 
            <a href="/ru/"></a>
          
             | 
            <a href="/tr/">Trke</a>
          
             | 
            <a href="/id/">Bahasa Indonesia</a>
          
             | 
            <a href="/bg/"></a>
          
        
      </p>
    </section>
    <section class="row">
      <p>&copy; CSS Animation. Site by <a href="http://hop.ie">Donovan</a></p>
    </section>
  </section>
</footer>

<script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
<script src="/javascript/site.js"></script>
<script src="/javascript/vendor/wow.min.js"></script>







<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script>new WOW().init();</script>

  </body>
</html>
